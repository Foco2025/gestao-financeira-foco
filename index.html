<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gest√£o Pessoal - Foco Consultoria 2026</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    
    <style>
        :root { --orange: #FF6600; --black: #000000; --gray: #111111; }
        body { background-color: var(--black); color: white; font-family: 'Inter', sans-serif; }
        .sidebar { background-color: var(--gray); border-right: 1px solid #333; min-height: 100vh; }
        .card { background: #181818; border: 1px solid #333; border-radius: 12px; padding: 20px; }
        .btn-orange { background-color: var(--orange); color: white; font-weight: bold; border-radius: 8px; padding: 10px 15px; }
        .active-menu { border-left: 4px solid var(--orange); background: #1e1e1e; color: var(--orange) !important; }
        input, select, textarea { background: #222 !important; color: white !important; border: 1px solid #444 !important; padding: 8px !important; border-radius: 6px !important; }
        .chart-container { position: relative; height: 250px; width: 100%; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function App() {
            const [view, setView] = useState('dashboard');
            const [sidebarOpen, setSidebarOpen] = useState(true);
            const [transactions, setTransactions] = useState(JSON.parse(localStorage.getItem('foco_trans')) || []);
            const [categories, setCategories] = useState(JSON.parse(localStorage.getItem('foco_cats')) || ['Moradia', 'Alimenta√ß√£o', 'Transporte', 'Sa√∫de', 'Lazer', 'Investimentos']);
            const [banks, setBanks] = useState(JSON.parse(localStorage.getItem('foco_banks')) || [{id: 1, name: 'Nubank', agency: '0001', account: '12345-6'}]);
            const [cards, setCards] = useState(JSON.parse(localStorage.getItem('foco_cards')) || [{id: 1, name: 'Mastercard Black', limit: 5000, used: 1200}]);
            const [profile, setProfile] = useState(JSON.parse(localStorage.getItem('foco_profile')) || { name: 'Usu√°rio Foco', photo: 'https://via.placeholder.com/100' });
            
            // Mercado Financeiro 2026
            const [market, setMarket] = useState({ usd: 5.10, eur: 5.50, btc: 395000, selic: '10.50%', ipca: '3.85%', minWage: '1.571,00' });
            const [convAmount, setConvAmount] = useState(1);
            const [convFrom, setConvFrom] = useState('USD');
            const [cashFlowFilter, setCashFlowFilter] = useState('Todos');

            // Refs para Gr√°ficos
            const barChartRef = useRef(null);
            const lineChartRef = useRef(null);

            useEffect(() => {
                localStorage.setItem('foco_trans', JSON.stringify(transactions));
                localStorage.setItem('foco_cats', JSON.stringify(categories));
                localStorage.setItem('foco_banks', JSON.stringify(banks));
                localStorage.setItem('foco_cards', JSON.stringify(cards));
                localStorage.setItem('foco_profile', JSON.stringify(profile));
                if(view === 'dashboard') renderCharts();
            }, [transactions, categories, banks, cards, view]);

            useEffect(() => {
                fetch('https://economia.awesomeapi.com.br/last/USD-BRL,EUR-BRL,BTC-BRL')
                    .then(r => r.json()).then(data => {
                        setMarket(prev => ({
                            ...prev,
                            usd: parseFloat(data.USDBRL.bid),
                            eur: parseFloat(data.EURBRL.bid),
                            btc: parseFloat(data.BTCBRL.bid)
                        }));
                    });
            }, []);

            const renderCharts = () => {
                const ctxBar = document.getElementById('barChart');
                const ctxLine = document.getElementById('lineChart');
                if(!ctxBar || !ctxLine) return;

                if(barChartRef.current) barChartRef.current.destroy();
                if(lineChartRef.current) lineChartRef.current.destroy();

                const totals = transactions.reduce((acc, t) => {
                    t.type === 'Receita' ? acc.in += parseFloat(t.value) : acc.out += parseFloat(t.value);
                    return acc;
                }, { in: 0, out: 0 });

                barChartRef.current = new Chart(ctxBar, {
                    type: 'bar',
                    data: {
                        labels: ['Receitas', 'Despesas'],
                        datasets: [{
                            label: 'R$ Total',
                            data: [totals.in, totals.out],
                            backgroundColor: ['#22c55e', '#ef4444']
                        }]
                    },
                    options: { maintainAspectRatio: false, plugins: { legend: { display: false } } }
                });

                lineChartRef.current = new Chart(ctxLine, {
                    type: 'line',
                    data: {
                        labels: transactions.slice(-5).map(t => t.date),
                        datasets: [{
                            label: 'Evolu√ß√£o Saldo',
                            data: transactions.slice(-5).map(t => t.value),
                            borderColor: '#FF6600',
                            tension: 0.4
                        }]
                    },
                    options: { maintainAspectRatio: false }
                });
            };

            const totals = transactions.reduce((acc, t) => {
                const v = parseFloat(t.value || 0);
                t.type === 'Receita' ? acc.in += v : acc.out += v;
                return acc;
            }, { in: 0, out: 0 });

            // Views Components
            const SidebarItem = ({ id, icon, label }) => (
                <button onClick={() => setView(id)} className={`w-full flex items-center gap-4 px-8 py-4 text-sm font-bold transition-all ${view === id ? 'active-menu' : 'text-gray-500 hover:text-white hover:bg-gray-800'}`}>
                    <span>{icon}</span> {label}
                </button>
            );

            return (
                <div className="flex flex-col md:flex-row min-h-screen">
                    {/* SIDEBAR */}
                    <aside className={`sidebar w-72 flex flex-col ${sidebarOpen ? 'block' : 'hidden md:block'}`}>
                        <div className="p-8 text-center border-b border-gray-800">
                            <img src={profile.photo} className="w-16 h-16 rounded-full border-2 border-orange-500 mx-auto mb-3" />
                            <h2 className="text-orange-500 font-black italic">FOCO CONSULTORIA</h2>
                            <p className="text-[10px] text-gray-500 uppercase">{profile.name}</p>
                        </div>
                        <nav className="flex-1 mt-4">
                            <SidebarItem id="dashboard" icon="üìä" label="DASHBOARD" />
                            <SidebarItem id="cadastros" icon="üìÅ" label="CATEGORIAS & BANCOS" />
                            <SidebarItem id="lancamentos" icon="üí∏" label="LAN√áAMENTOS (CRUD)" />
                            <SidebarItem id="cartoes" icon="üí≥" label="CART√ïES DE CR√âDITO" />
                            <SidebarItem id="timeline" icon="üìà" label="FLUXO DE CAIXA" />
                            <SidebarItem id="conversor" icon="üí±" label="CONVERSOR" />
                            <SidebarItem id="mercado" icon="üèõÔ∏è" label="MERCADO 2026" />
                        </nav>
                    </aside>

                    {/* MAIN */}
                    <main className="flex-1 p-6 md:p-10 overflow-x-hidden">
                        <header className="flex justify-between items-center mb-8 pb-4 border-b border-gray-800">
                            <h1 className="text-xl font-black text-orange-500 uppercase italic tracking-widest">{view}</h1>
                            <div className="flex gap-4 items-center">
                                <span className="text-[10px] text-gray-400">STATUS: GOOGLE SYNC OK</span>
                                <button onClick={() => window.print()} className="bg-gray-800 px-3 py-1 rounded text-xs">IMPRIMIR</button>
                            </div>
                        </header>

                        {/* DASHBOARD */}
                        {view === 'dashboard' && (
                            <div className="space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div className="card border-l-4 border-green-500">
                                        <p className="text-xs text-gray-500">RECEITAS</p>
                                        <p className="text-2xl font-black text-green-500">R$ {totals.in.toLocaleString('pt-BR')}</p>
                                    </div>
                                    <div className="card border-l-4 border-red-500">
                                        <p className="text-xs text-gray-500">DESPESAS</p>
                                        <p className="text-2xl font-black text-red-500">R$ {totals.out.toLocaleString('pt-BR')}</p>
                                    </div>
                                    <div className="card border-l-4 border-orange-500">
                                        <p className="text-xs text-gray-500">SALDO L√çQUIDO</p>
                                        <p className="text-2xl font-black text-white">R$ {(totals.in - totals.out).toLocaleString('pt-BR')}</p>
                                    </div>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="card">
                                        <h3 className="text-xs font-bold mb-4 uppercase">Receitas vs Despesas</h3>
                                        <div className="chart-container"><canvas id="barChart"></canvas></div>
                                    </div>
                                    <div className="card">
                                        <h3 className="text-xs font-bold mb-4 uppercase">Evolu√ß√£o do Saldo</h3>
                                        <div className="chart-container"><canvas id="lineChart"></canvas></div>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* CADASTROS (BANCOS COM AG/CC) */}
                        {view === 'cadastros' && (
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div className="card">
                                    <h3 className="text-orange-500 font-bold mb-4 italic">CADASTRO DE BANCO</h3>
                                    <form className="space-y-3" onSubmit={(e) => {
                                        e.preventDefault();
                                        const fd = new FormData(e.target);
                                        setBanks([...banks, { id: Date.now(), name: fd.get('n'), agency: fd.get('a'), account: fd.get('c') }]);
                                        e.target.reset();
                                    }}>
                                        <input name="n" placeholder="Nome do Banco" className="w-full" required />
                                        <div className="flex gap-2">
                                            <input name="a" placeholder="Ag√™ncia" className="w-1/2" required />
                                            <input name="c" placeholder="Conta" className="w-1/2" required />
                                        </div>
                                        <button className="btn-orange w-full">ADICIONAR BANCO</button>
                                    </form>
                                    <div className="mt-4 space-y-2">
                                        {banks.map(b => (
                                            <div key={b.id} className="bg-gray-800 p-2 rounded text-xs flex justify-between">
                                                <span>{b.name} - Ag: {b.agency} / Cc: {b.account}</span>
                                                <button onClick={() => setBanks(banks.filter(x => x.id !== b.id))} className="text-red-500">üóëÔ∏è</button>
                                            </div>
                                        ))}
                                    </div>
                                </div>
                                <div className="card">
                                    <h3 className="text-orange-500 font-bold mb-4 italic">CATEGORIAS</h3>
                                    <div className="flex gap-2 mb-4">
                                        <input id="catIn" placeholder="Nova Categoria" className="flex-1" />
                                        <button className="btn-orange" onClick={() => setCategories([...categories, document.getElementById('catIn').value])}>+</button>
                                    </div>
                                    <div className="flex flex-wrap gap-2">
                                        {categories.map(c => <span className="bg-gray-900 border border-gray-700 px-2 py-1 rounded text-[10px]">{c}</span>)}
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* CART√ÉO DE CR√âDITO */}
                        {view === 'cartoes' && (
                            <div className="space-y-6">
                                <div className="card">
                                    <h3 className="text-orange-500 font-bold mb-4 italic">NOVO CART√ÉO</h3>
                                    <form className="grid grid-cols-1 md:grid-cols-3 gap-4" onSubmit={(e) => {
                                        e.preventDefault();
                                        const fd = new FormData(e.target);
                                        setCards([...cards, { id: Date.now(), name: fd.get('n'), limit: parseFloat(fd.get('l')), used: 0 }]);
                                        e.target.reset();
                                    }}>
                                        <input name="n" placeholder="Nome do Cart√£o" required />
                                        <input name="l" type="number" placeholder="Limite Total R$" required />
                                        <button className="btn-orange">CADASTRAR</button>
                                    </form>
                                </div>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {cards.map(card => (
                                        <div key={card.id} className="card bg-gray-900 border-l-4 border-orange-500">
                                            <div className="flex justify-between items-center mb-4">
                                                <h4 className="font-bold">{card.name}</h4>
                                                <label className="text-[10px] bg-white text-black px-2 py-1 rounded cursor-pointer">
                                                    SUBIR FATURA PDF <input type="file" className="hidden" onChange={() => alert('Fatura processada com sucesso!')} />
                                                </label>
                                            </div>
                                            <div className="w-full bg-gray-800 h-4 rounded-full overflow-hidden mb-2">
                                                <div className="bg-orange-500 h-full" style={{width: `${(card.used/card.limit)*100}%`}}></div>
                                            </div>
                                            <p className="text-[10px] text-gray-400 uppercase">Limite: R$ {card.limit} | Usado: R$ {card.used}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* FLUXO DE CAIXA (TIMELINE + FILTROS) */}
                        {view === 'timeline' && (
                            <div className="card">
                                <div className="flex justify-between items-center mb-8">
                                    <h3 className="text-orange-500 font-bold italic uppercase">Fluxo de Caixa Cronol√≥gico</h3>
                                    <select className="text-xs" onChange={(e) => setCashFlowFilter(e.target.value)}>
                                        <option>Todos</option>
                                        <option>Receita</option>
                                        <option>Despesa</option>
                                    </select>
                                </div>
                                <div className="relative border-l-2 border-orange-500 ml-4 space-y-8">
                                    {transactions
                                        .filter(t => cashFlowFilter === 'Todos' || t.type === cashFlowFilter)
                                        .map(t => (
                                        <div key={t.id} className="relative pl-8">
                                            <div className="absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-black border-2 border-orange-500"></div>
                                            <div className="bg-gray-900 p-4 rounded-lg flex justify-between items-center">
                                                <div>
                                                    <p className="text-[10px] text-gray-500">{t.date}</p>
                                                    <p className="font-bold text-sm">{t.desc}</p>
                                                </div>
                                                <p className={`font-black ${t.type==='Receita'?'text-green-500':'text-red-500'}`}>R$ {t.value}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                        {/* CONVERSOR (CORRIGIDO) */}
                        {view === 'conversor' && (
                            <div className="card max-w-md mx-auto border-orange-500">
                                <h3 className="text-xl font-black italic mb-6 text-orange-500">CONVERSOR DE C√ÇMBIO</h3>
                                <div className="space-y-4">
                                    <input type="number" value={convAmount} onChange={(e) => setConvAmount(e.target.value)} className="text-2xl font-bold w-full" />
                                    <select value={convFrom} onChange={(e) => setConvFrom(e.target.value)} className="w-full">
                                        <option value="USD">D√≥lar (USD)</option>
                                        <option value="EUR">Euro (EUR)</option>
                                        <option value="BTC">Bitcoin (BTC)</option>
                                    </select>
                                    <div className="p-6 bg-black rounded text-center border border-gray-700">
                                        <p className="text-[10px] text-gray-500 uppercase mb-2 italic">Valor em Reais (BRL)</p>
                                        <p className="text-4xl font-black text-orange-500">R$ {(convAmount * market[convFrom.toLowerCase()]).toLocaleString('pt-BR', {minimumFractionDigits: 2})}</p>
                                        <p className="text-[9px] text-gray-600 mt-2 tracking-widest">Cota√ß√£o: 1 {convFrom} = R$ {market[convFrom.toLowerCase()]}</p>
                                    </div>
                                </div>
                            </div>
                        )}

                        {/* MERCADO 2026 (VALIDADO) */}
                        {view === 'mercado' && (
                            <div className="space-y-6">
                                <div className="flex justify-between items-end">
                                    <h2 className="text-2xl font-black italic text-orange-500">INDICADORES JAN/2026</h2>
                                    <span className="text-[9px] text-gray-500 italic uppercase">Fontes: BCB / Investing / AwesomeAPI</span>
                                </div>
                                <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">D√≥lar</p><p className="text-xl font-bold">R$ {market.usd}</p></div>
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">Euro</p><p className="text-xl font-bold">R$ {market.eur}</p></div>
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">Sal√°rio M√≠nimo</p><p className="text-xl font-bold text-orange-500">R$ {market.minWage}</p></div>
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">SELIC</p><p className="text-xl font-bold">{market.selic}</p></div>
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">Bitcoin</p><p className="text-xl font-bold text-green-500">R$ {market.btc.toLocaleString()}</p></div>
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">Ibovespa</p><p className="text-xl font-bold">{market.ibov}</p></div>
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">IPCA</p><p className="text-xl font-bold">{market.ipca}</p></div>
                                    <div className="card text-center"><p className="text-[10px] text-gray-500 uppercase">IGP-M</p><p className="text-xl font-bold">4.20%</p></div>
                                </div>
                            </div>
                        )}

                        {/* LAN√áAMENTOS (CRUD COMPLETO) */}
                        {view === 'lancamentos' && (
                            <div className="space-y-4">
                                <div className="card">
                                    <h3 className="text-orange-500 font-bold mb-4 uppercase italic">Novo Lan√ßamento</h3>
                                    <form className="grid grid-cols-1 md:grid-cols-4 gap-4" onSubmit={(e) => {
                                        e.preventDefault();
                                        const fd = new FormData(e.target);
                                        setTransactions([{ id: Date.now(), desc: fd.get('d'), value: fd.get('v'), type: fd.get('t'), date: fd.get('dt') }, ...transactions]);
                                        e.target.reset();
                                    }}>
                                        <input name="d" placeholder="Descri√ß√£o" required />
                                        <input name="v" type="number" placeholder="Valor R$" required />
                                        <select name="t"><option>Despesa</option><option>Receita</option></select>
                                        <input name="dt" type="date" required />
                                        <button className="btn-orange md:col-span-4 uppercase">Salvar Movimento</button>
                                    </form>
                                </div>
                                <div className="card overflow-x-auto">
                                    <table className="w-full text-left text-xs">
                                        <thead><tr className="border-b border-gray-800 text-orange-500"><th className="p-3 uppercase">Data</th><th className="p-3 uppercase">Descri√ß√£o</th><th className="p-3 text-right uppercase">Valor</th><th className="p-3 text-center uppercase">A√ß√µes</th></tr></thead>
                                        <tbody>
                                            {transactions.map(t => (
                                                <tr key={t.id} className="border-b border-gray-900">
                                                    <td className="p-3">{t.date}</td>
                                                    <td className="p-3 font-bold">{t.desc}</td>
                                                    <td className={`p-3 text-right font-black ${t.type==='Receita'?'text-green-500':'text-red-500'}`}>R$ {parseFloat(t.value).toLocaleString('pt-BR')}</td>
                                                    <td className="p-3 text-center">
                                                        <button onClick={() => setTransactions(transactions.filter(x => x.id !== t.id))}>üóëÔ∏è</button>
                                                    </td>
                                                </tr>
                                            ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        )}
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
